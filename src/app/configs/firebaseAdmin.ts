import admin from "firebase-admin";
import path from "path";
import fs from "fs";

// If using CommonJS (tsc default module), __dirname exists
const serviceAccountPath = path.join(__dirname, "serviceAccountKey.json");

const serviceAccount = JSON.parse(
  fs.readFileSync(serviceAccountPath, "utf8")
) as admin.ServiceAccount;

if (!admin.apps.length) {
  admin.initializeApp({
    credential: admin.credential.cert(serviceAccount),
  });
}

export const messaging = admin.messaging();
export const db = admin.firestore();
export default admin;
